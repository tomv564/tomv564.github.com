
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>Tom van Ommeren's blog</title>
	<meta name="author" content="Tom van Ommeren">

	
	<meta name="description" content="Let&rsquo;s make a game. Better yet, let&rsquo;s copy one. Let&rsquo;s implement MasterMind in Ruby. The living project for this article is on &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="Tom van Ommeren's blog" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script async="true" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	
</head>


<body>
	<header id="header" class="inner"><h1><a href="/">Tom van Ommeren's blog</a></h1>
<nav id="main-nav"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
</ul>
</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="http://google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:tomv564.github.io">
			</form>
		</div>
	</div>
</nav>
<nav id="sub-nav" class="alignright">
	<div class="social">
		
		
		
		<a class="twitter" href="http://twitter.com/tomvanommeren" title="Twitter">Twitter</a>
		
		
		<a class="github" href="https://github.com/tomv564" title="GitHub">GitHub</a>
		
    
		
		
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
    
	</div>
	<form class="search" action="http://google.com/search" method="get">
		<input class="alignright" type="text" name="q" results="0">
		<input type="hidden" name="q" value="site:tomv564.github.io">
	</form>
</nav>

</header>
	
		
	
	<div id="content" class="inner">


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2013/12/14/ruby-rspec-and-git-a-guessing-game/">
		
			Ruby, Rspec and Git, a Guessing Game</a>
	</h2>
	<div class="entry-content">
		<p>Let&rsquo;s make a game. Better yet, let&rsquo;s copy one. Let&rsquo;s implement <a href="http://en.wikipedia.org/wiki/Mastermind_(board_game">MasterMind</a> in Ruby.</p>

<p>The living project for this article is on <a href="https://github.com/tomv564/mastermind">GitHub</a></p>

<h3>Prep</h3>

<p>First, set up a ruby on your machine using <a href="http://railsapps.github.io/installrubyonrails-mac.html">this guide</a> about RVM.</p>

<p>Create an empty class, we&rsquo;ll call it game.rb.
For Ruby, RSpec and TestUnit are popular. We&rsquo;ll use RSpec for now:</p>

<p>First, install the rspec gem:</p>

<div>
  <pre><code class='bash'>gem install rspec</code></pre>
</div>


<p>Rspec seems happiest when you put all the tests in a spec folder, so let&rsquo;s go ahead create our test file in <strong>spec/game_spec.rb</strong></p>

<h3>Write some tests</h3>

<p>Here is our first test scenario:</p>

<div>
  <pre><code class='ruby'>require_relative &#39;../game&#39;

describe Game do 
    it &quot;requires an answer&quot; do
        expect{Game.new}.to raise_error(ArgumentError)
    end     
end</code></pre>
</div>


<p>This file tells RSpec</p>

<ol>
<li>Load a Ruby object called <em>game</em> from the parent directory</li>
<li>We are going to test an object called <em>Game</em></li>
<li>This test case is called <em>requires an answer</em></li>
<li><strong>expect</strong> warns RSpec that <em>Game.new</em> will throw an Exception</li>
<li>We expect this exception to be an <em>ArgumentError</em>.</li>
</ol>


<h3>Run them</h3>

<p>As long as all your spec files live in a spec directory, you can simply type the following your project directory:</p>

<div>
  <pre><code class='bash'>rspec</code></pre>
</div>


<p>You should see 1 failed test.</p>

<h3>Write some code</h3>

<p>You&rsquo;re on your own here. Read up on the Mastermind rules on Wikipedia, then code:</p>

<ol>
<li>Write a failing test</li>
<li>Write the minimal amount of code to fix the test</li>
<li>Goto 1</li>
<li>Refactor to clean up as necessary</li>
</ol>


<h2>So, you&rsquo;re done</h2>

<p>You have a working game class. We want to take a moment to save our progress.</p>

<h3>Create a git repository</h3>

<p>First, convert your project to a local git repository</p>

<div>
  <pre><code class='bash'>git add .
git commmit -m &#39;initial commit&#39;</code></pre>
</div>


<h3>Push it to github</h3>

<ol>
<li>Create the repository on GitHub <a href="https://help.github.com/articles/create-a-repo">Instructions here</a></li>
<li>Add the github repository as the origin remote (<a href="https://help.github.com/articles/adding-a-remote">See this help page</a></li>
</ol>


<div>
  <pre><code class='bash'>git remote add origin https://github.com/user/repo.git # replace user and repo with your own repository details</code></pre>
</div>


<ol>
<li>Push-pull to sync</li>
</ol>


<div>
  <pre><code class='bash'>git pull origin master
git push origin master</code></pre>
</div>


<h2>Automating the tests</h2>

<p>Your work is now saved outside your machine, you can give others access to your repository and collaborate. But with everyone stirring the pot at the same time, how do you know everything&rsquo;s still working? The answer is continuous integration: we&rsquo;re going to run a service to run the tests whenever someone checks in code.</p>

<h3>Set up a rake task</h3>

<p>We need a way to tell a 3rd party how to run the tests on our project. In Ruby, this is called the <strong>Rakefile</strong>:</p>

<div>
  <pre><code class='ruby'>require &#39;rspec/core/rake_task&#39;

RSpec::Core::RakeTask.new(:spec)

task :default =&gt; :spec</code></pre>
</div>


<p>This does the following:</p>

<ol>
<li>Tell Rake we want to use rspec</li>
<li>Creates an RSpec task, naming it :spec</li>
<li>Tells Rake that the default task is our :spec task.</li>
</ol>


<p>Create and save this file in the project&rsquo;s directory, and run the following:</p>

<div>
  <pre><code class='bash'>rake</code></pre>
</div>


<p>You can see that rake starts up RSpec, the output should be the same as running rspec.</p>

<h3>Set up a gemfile for Travis</h3>

<p>The service we&rsquo;re going to use, <a href="https://travis-ci.org">Travis</a>, now knows how it can run our tests. But it has no idea what our ruby environment looks like. We need to create these files in our project directory.</p>

<h4>.travis.yml</h4>

<div>
  <pre><code class='ruby'>language: ruby
rvm:
  - 2.0.0</code></pre>
</div>


<p>This file tells Travis that we are a ruby project, and we want Ruby 2.0.0</p>

<h4>Gemfile</h4>

<div>
  <pre><code class='ruby'>source &#39;https://rubygems.org&#39;
gem &quot;rspec&quot;    , &quot;~&gt; 2.14.1&quot;</code></pre>
</div>


<p>This file tells Travis that we want to use a recent version of RSpec.
Create these two files for now, we will send them to GitHub after the next step.</p>

<h3>Sign up for Travis</h3>

<p>Visit <a href="https://travis-ci.org">Travis</a>, sign up with your GitHub account and tell it to sync your MasterMind repository.</p>

<p>To tell Travis to make its first build, add the two files we just created using <strong>git add</strong> and <strong>git push</strong> them to GitHub.</p>

<h3>Watch your inbox.</h3>

<p>This can take a few minutes, but eventually Travis will pick up the changes and try to run the tests on their own server. If it worked, you&rsquo;ll see this reward:</p>

<p><a href="https://travis-ci.org/tomv564/mastermind"><img src="https://travis-ci.org/tomv564/mastermind.png?branch=master" alt="Build Status" /></a></p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-12-14T00:00:00+01:00" pubdate data-updated="true"></time></div>
	<div class="tags">


	<a class='category' href='/blog/categories//'></a>


</div>
	
</div>
</article>

<nav id="pagenavi">
    
        <a href="/blog/page/4/" class="prev">Prev</a>
    
    
    <div class="center"><a href="/blog/archives">Blog Archives</a></div>
</nav></div>
	<footer id="footer" class="inner">Copyright &copy; 2014

    Tom van Ommeren

</footer>
	<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->




	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-7601332-2']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>



</body>
</html>