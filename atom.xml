<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Tom van Ommeren's blog]]></title>
  <link href="http://tomv564.github.io/atom.xml" rel="self"/>
  <link href="http://tomv564.github.io/"/>
  <updated>2014-01-26T17:17:05+01:00</updated>
  <id>http://tomv564.github.io/</id>
  <author>
    <name><![CDATA[Tom van Ommeren]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[MasterMind Part 2: Adding a front end]]></title>
    <link href="http://tomv564.github.io/blog/2014/01/26/mastermind-part-2-adding-a-front-end/"/>
    <updated>2014-01-26T16:31:49+01:00</updated>
    <id>http://tomv564.github.io/blog/2014/01/26/mastermind-part-2-adding-a-front-end</id>
    <content type="html"><![CDATA[<p>The <a href="http://tomv564.github.io/blog/2013/12/14/ruby-rspec-and-git-a-guessing-game/">previous post</a> was an exercise in building well-tested logic. To turn this in to a workable application, two things need to happen:</p>

<ol>
<li>A front-end needs to be built</li>
<li>The back-end needs to be hosted in a web app</li>
</ol>


<p>In fact, you could build the whole thing as a front-end app, but then you would miss out on building a minimalistic Ruby web app.</p>

<p>So, let&rsquo;s mock up a front end in <a href="http://www.balsamiq.com/">Balsamiq</a>.</p>

<p><img src="https://raw2.github.com/tomv564/mastermind/master/mockup.png" alt="mockup" /></p>

<h3>HTML template</h3>

<p>Because I don&rsquo;t want to work hard to get pretty fonts and buttons, <a href="http://getbootstrap.com">download Bootstrap</a> and use their basic html template.</p>

<p>The board is made up of nested lists, the markup looks roughly like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;board&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>
</span><span class='line'>    <span class="nt">&lt;ul</span> <span class="na">id=</span><span class="s">&quot;answer&quot;</span> <span class="na">class=</span><span class="s">&quot;code list-unstyled&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>      <span class="nt">&lt;li&gt;</span>?<span class="nt">&lt;/li&gt;</span>
</span><span class='line'>      <span class="nt">&lt;li&gt;</span>?<span class="nt">&lt;/li&gt;</span>
</span><span class='line'>      <span class="nt">&lt;li&gt;</span>?<span class="nt">&lt;/li&gt;</span>
</span><span class='line'>      <span class="nt">&lt;li&gt;</span>?<span class="nt">&lt;/li&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/ul&gt;</span>
</span><span class='line'>
</span><span class='line'>    <span class="nt">&lt;ul</span> <span class="na">id=</span><span class="s">&quot;guesses&quot;</span> <span class="na">class=</span><span class="s">&quot;list-unstyled&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>      <span class="nt">&lt;li&gt;</span>
</span><span class='line'>        <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">&quot;code list-unstyled&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>          <span class="nt">&lt;li&gt;&lt;/li&gt;</span>
</span><span class='line'>          <span class="nt">&lt;li&gt;&lt;/li&gt;</span>
</span><span class='line'>          <span class="nt">&lt;li&gt;&lt;/li&gt;</span>
</span><span class='line'>          <span class="nt">&lt;li&gt;&lt;/li&gt;</span>
</span><span class='line'>        <span class="nt">&lt;/ul&gt;</span>
</span><span class='line'>        <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">&quot;score list-unstyled&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>          <span class="nt">&lt;li</span> <span class="na">class=</span><span class="s">&quot;black&quot;</span><span class="nt">&gt;</span><span class="ni">&amp;nbsp;</span><span class="nt">&lt;/li&gt;</span>
</span><span class='line'>          <span class="nt">&lt;li</span> <span class="na">class=</span><span class="s">&quot;white&quot;</span><span class="nt">&gt;</span><span class="ni">&amp;nbsp;</span><span class="nt">&lt;/li&gt;</span>
</span><span class='line'>          <span class="nt">&lt;li</span> <span class="na">class=</span><span class="s">&quot;white&quot;</span><span class="nt">&gt;</span><span class="ni">&amp;nbsp;</span><span class="nt">&lt;/li&gt;</span>
</span><span class='line'>
</span><span class='line'>        <span class="nt">&lt;/ul&gt;</span>
</span><span class='line'>      <span class="nt">&lt;/li&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/ul&gt;</span>
</span><span class='line'>
</span><span class='line'>  <span class="nt">&lt;/div&gt;</span>
</span><span class='line'>
</span><span class='line'>  <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;addguess&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">&quot;code list-unstyled&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>      <span class="nt">&lt;li&gt;&lt;/li&gt;</span>
</span><span class='line'>      <span class="nt">&lt;li&gt;&lt;/li&gt;</span>
</span><span class='line'>      <span class="nt">&lt;li&gt;&lt;/li&gt;</span>
</span><span class='line'>      <span class="nt">&lt;li&gt;&lt;/li&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/ul&gt;</span>
</span><span class='line'>    <span class="nt">&lt;button</span> <span class="na">id=</span><span class="s">&quot;addguessbutton&quot;</span> <span class="na">type=</span><span class="s">&quot;button&quot;</span> <span class="na">class=</span><span class="s">&quot;btn btn-xs btn-primary&quot;</span><span class="nt">&gt;&lt;span</span> <span class="na">class=</span><span class="s">&quot;glyphicon glyphicon-ok&quot;</span><span class="nt">&gt;&lt;/span&gt;&lt;/button&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/div&gt;</span>
</span><span class='line'>
</span><span class='line'>  <span class="nt">&lt;ul</span> <span class="na">id=</span><span class="s">&quot;turns&quot;</span> <span class="na">class=</span><span class="s">&quot;list-unstyled&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;li&gt;</span>
</span><span class='line'>      <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">&quot;code list-unstyled&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>        <span class="nt">&lt;li&gt;&lt;/li&gt;</span>
</span><span class='line'>        <span class="nt">&lt;li&gt;&lt;/li&gt;</span>
</span><span class='line'>        <span class="nt">&lt;li&gt;&lt;/li&gt;</span>
</span><span class='line'>        <span class="nt">&lt;li&gt;&lt;/li&gt;</span>
</span><span class='line'>      <span class="nt">&lt;/ul&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/li&gt;</span>
</span><span class='line'>     <span class="nt">&lt;li&gt;</span>
</span><span class='line'>      <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">&quot;code list-unstyled&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>        <span class="nt">&lt;li&gt;&lt;/li&gt;</span>
</span><span class='line'>        <span class="nt">&lt;li&gt;&lt;/li&gt;</span>
</span><span class='line'>        <span class="nt">&lt;li&gt;&lt;/li&gt;</span>
</span><span class='line'>        <span class="nt">&lt;li&gt;&lt;/li&gt;</span>
</span><span class='line'>      <span class="nt">&lt;/ul&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/li&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/ul&gt;</span>
</span><span class='line'>
</span><span class='line'>  <span class="nt">&lt;/div&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>The following CSS turns those list items into circles:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="nt">ul</span><span class="nc">.code</span> <span class="nt">li</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">float</span><span class="o">:</span> <span class="k">left</span><span class="p">;</span>
</span><span class='line'>        <span class="k">border</span><span class="o">:</span> <span class="m">2px</span> <span class="k">solid</span> <span class="m">#999</span><span class="p">;</span>
</span><span class='line'>        <span class="k">margin-left</span><span class="o">:</span> <span class="m">5px</span><span class="p">;</span>
</span><span class='line'>        <span class="k">width</span><span class="o">:</span> <span class="m">30px</span><span class="p">;</span>
</span><span class='line'>        <span class="k">height</span><span class="o">:</span> <span class="m">28px</span><span class="p">;</span>
</span><span class='line'>        <span class="k">border</span><span class="o">-</span><span class="n">radius</span><span class="o">:</span> <span class="m">20px</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Tying it together: the javascript</h3>

<p>To encapsulate the logic for the whole page, I started with this basic pattern:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Mastermind</span> <span class="o">=</span> <span class="k">new</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">// private variables</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">selectedPeg</span><span class="p">;</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">lastGuess</span><span class="p">;</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">gameId</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">// private functions </span>
</span><span class='line'>
</span><span class='line'>          <span class="kd">var</span> <span class="nx">addGuess</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">reset</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">// first load: attach handlers and reset game.</span>
</span><span class='line'>
</span><span class='line'>        <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#newgamebutton&#39;</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="nx">reset</span><span class="p">);</span>
</span><span class='line'>        <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#addguessbutton&#39;</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="nx">addGuess</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>        <span class="nx">reset</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">return</span> <span class="p">{</span>
</span><span class='line'>                <span class="c1">// public functions and variables</span>
</span><span class='line'>
</span><span class='line'>        <span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="p">}();</span>
</span></code></pre></td></tr></table></div></figure>


<p>It is based on <a href="http://javascript.crockford.com/private.html">Crockford&rsquo;s private members in Javascript</a> and helps keep your objects tight and neat.</p>

<p>The implementation at this point can be seen at <a href="https://github.com/tomv564/mastermind/tree/d01d3bf8de635b97462c6aa7060f7b679a6f37ef">this commit in GitHub</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Ruby, rspec and git, a guessing game]]></title>
    <link href="http://tomv564.github.io/blog/2013/12/14/ruby-rspec-and-git-a-guessing-game/"/>
    <updated>2013-12-14T00:00:00+01:00</updated>
    <id>http://tomv564.github.io/blog/2013/12/14/ruby-rspec-and-git-a-guessing-game</id>
    <content type="html"><![CDATA[<p>Let&rsquo;s make a game. Better yet, let&rsquo;s copy one. Let&rsquo;s implement <a href="http://en.wikipedia.org/wiki/Mastermind_(board_game">MasterMind</a> in Ruby.</p>

<p>The living project for this article is on <a href="https://github.com/tomv564/mastermind">GitHub</a></p>

<h3>Prep</h3>

<p>First, set up a ruby on your machine using <a href="http://railsapps.github.io/installrubyonrails-mac.html">this guide</a> about RVM.</p>

<p>Create an empty class, we&rsquo;ll call it game.rb.
For Ruby, RSpec and TestUnit are popular. We&rsquo;ll use RSpec for now:</p>

<p>First, install the rspec gem:</p>

<div>
  <pre><code class='bash'>gem install rspec</code></pre>
</div>


<p>Rspec seems happiest when you put all the tests in a spec folder, so let&rsquo;s go ahead create our test file in <strong>spec/game_spec.rb</strong></p>

<h3>Write some tests</h3>

<p>Here is our first test scenario:</p>

<div>
  <pre><code class='ruby'>require_relative &#39;../game&#39;

describe Game do 
    it &quot;requires an answer&quot; do
        expect{Game.new}.to raise_error(ArgumentError)
    end     
end</code></pre>
</div>


<p>This file tells RSpec</p>

<ol>
<li>Load a Ruby object called <em>game</em> from the parent directory</li>
<li>We are going to test an object called <em>Game</em></li>
<li>This test case is called <em>requires an answer</em></li>
<li><strong>expect</strong> warns RSpec that <em>Game.new</em> will throw an Exception</li>
<li>We expect this exception to be an <em>ArgumentError</em>.</li>
</ol>


<h3>Run them</h3>

<p>As long as all your spec files live in a spec directory, you can simply type the following your project directory:</p>

<div>
  <pre><code class='bash'>rspec</code></pre>
</div>


<p>You should see 1 failed test.</p>

<h3>Write some code</h3>

<p>You&rsquo;re on your own here. Read up on the Mastermind rules on Wikipedia, then code:</p>

<ol>
<li>Write a failing test</li>
<li>Write the minimal amount of code to fix the test</li>
<li>Goto 1</li>
<li>Refactor to clean up as necessary</li>
</ol>


<h2>So, you&rsquo;re done</h2>

<p>You have a working game class. We want to take a moment to save our progress.</p>

<h3>Create a git repository</h3>

<p>First, convert your project to a local git repository</p>

<div>
  <pre><code class='bash'>git add .
git commmit -m &#39;initial commit&#39;</code></pre>
</div>


<h3>Push it to github</h3>

<ol>
<li>Create the repository on GitHub <a href="https://help.github.com/articles/create-a-repo">Instructions here</a></li>
<li>Add the github repository as the origin remote (<a href="https://help.github.com/articles/adding-a-remote">See this help page</a></li>
</ol>


<div>
  <pre><code class='bash'>git remote add origin https://github.com/user/repo.git # replace user and repo with your own repository details</code></pre>
</div>


<ol>
<li>Push-pull to sync</li>
</ol>


<div>
  <pre><code class='bash'>git pull origin master
git push origin master</code></pre>
</div>


<h2>Automating the tests</h2>

<p>Your work is now saved outside your machine, you can give others access to your repository and collaborate. But with everyone stirring the pot at the same time, how do you know everything&rsquo;s still working? The answer is continuous integration: we&rsquo;re going to run a service to run the tests whenever someone checks in code.</p>

<h3>Set up a rake task</h3>

<p>We need a way to tell a 3rd party how to run the tests on our project. In Ruby, this is called the <strong>Rakefile</strong>:</p>

<div>
  <pre><code class='ruby'>require &#39;rspec/core/rake_task&#39;

RSpec::Core::RakeTask.new(:spec)

task :default =&gt; :spec</code></pre>
</div>


<p>This does the following:</p>

<ol>
<li>Tell Rake we want to use rspec</li>
<li>Creates an RSpec task, naming it :spec</li>
<li>Tells Rake that the default task is our :spec task.</li>
</ol>


<p>Create and save this file in the project&rsquo;s directory, and run the following:</p>

<div>
  <pre><code class='bash'>rake</code></pre>
</div>


<p>You can see that rake starts up RSpec, the output should be the same as running rspec.</p>

<h3>Set up a gemfile for Travis</h3>

<p>The service we&rsquo;re going to use, <a href="https://travis-ci.org">Travis</a>, now knows how it can run our tests. But it has no idea what our ruby environment looks like. We need to create these files in our project directory.</p>

<h4>.travis.yml</h4>

<div>
  <pre><code class='ruby'>language: ruby
rvm:
  - 2.0.0</code></pre>
</div>


<p>This file tells Travis that we are a ruby project, and we want Ruby 2.0.0</p>

<h4>Gemfile</h4>

<div>
  <pre><code class='ruby'>source &#39;https://rubygems.org&#39;
gem &quot;rspec&quot;    , &quot;~&gt; 2.14.1&quot;</code></pre>
</div>


<p>This file tells Travis that we want to use a recent version of RSpec.
Create these two files for now, we will send them to GitHub after the next step.</p>

<h3>Sign up for Travis</h3>

<p>Visit <a href="https://travis-ci.org">Travis</a>, sign up with your GitHub account and tell it to sync your MasterMind repository.</p>

<p>To tell Travis to make its first build, add the two files we just created using <strong>git add</strong> and <strong>git push</strong> them to GitHub.</p>

<h3>Watch your inbox.</h3>

<p>This can take a few minutes, but eventually Travis will pick up the changes and try to run the tests on their own server. If it worked, you&rsquo;ll see this reward:</p>

<p><a href="https://travis-ci.org/tomv564/mastermind"><img src="https://travis-ci.org/tomv564/mastermind.png?branch=master" alt="Build Status" /></a></p>
]]></content>
  </entry>
  
</feed>
